{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-lg p-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">{{ form_name }}</h2>
        <p class="text-gray-600 mb-6">Điền đầy đủ thông tin vào biểu mẫu bên dưới</p>

        <form id="requestForm" class="space-y-6">
            <input type="hidden" name="loai_mau" value="{{ loai_mau }}">

            <!-- Biển số -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Biển số xe <span class="text-red-500">*</span>
                </label>
                <input
                    type="text"
                    name="bien_so"
                    value="{{ bien_so }}"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 uppercase"
                    required
                >
            </div>

            <!-- Common fields -->
            <div class="grid md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Màu biển</label>
                    <select name="mau_bien" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                        <option value="">Chọn màu biển</option>
                        <option value="Xanh" {% if vehicle and vehicle.mau_bien == '1' %}selected{% endif %}>Xanh</option>
                        <option value="Trắng/Vàng" {% if vehicle and vehicle.mau_bien == '0' %}selected{% endif %}>Trắng/Vàng</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Loại xe</label>
                    <input
                        type="text"
                        name="loai_xe"
                        value="{% if vehicle %}{{ vehicle.loai_xe }}{% endif %}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Chủ xe</label>
                    <input
                        type="text"
                        name="chu_xe"
                        value="{% if vehicle %}{{ vehicle.ten }}{% endif %}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ của chủ xe</label>
                <input
                    type="text"
                    name="dia_chi_chu_xe"
                    value="{% if vehicle %}{{ vehicle.dia_chi_dang_ky_xe }}{% endif %}"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                >
            </div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Số điện thoại chủ xe</label>
                    <input
                        type="text"
                        name="so_dien_thoai_chu_xe"
                        value="{% if vehicle %}{{ vehicle.so_dien_thoai }}{% endif %}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Số CCCD/mã số thuế chủ xe</label>
                    <input
                        type="text"
                        name="ma_so_thue_chu_xe"
                        value="{% if vehicle %}{{ vehicle.so_giay_to }}{% endif %}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>
            </div>

            <div class="grid md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ngày cấp CCCD</label>
                    <input
                        type="date"
                        name="ngay_cap_cccd_chu_xe"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Số GPLX của chủ xe</label>
                    <input
                        type="text"
                        name="so_gplx_chu_xe"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ngày cấp GPLX</label>
                    <input
                        type="date"
                        name="ngay_cap_gplx_chu_xe"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    >
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Cơ quan cấp GPLX</label>
                <input
                    type="text"
                    name="co_quan_cap_gplx_chu_xe"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    placeholder="VD: Cục Cảnh sát giao thông"
                >
            </div>

            {% if loai_mau == 6 %}
            <!-- For form 6: Vehicle identification fields -->
            <div class="bg-yellow-50 p-4 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-3">Thông tin định danh xe</h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Số khung của xe</label>
                        <input
                            type="text"
                            name="so_khung"
                            value="{% if vehicle %}{{ vehicle.so_khung }}{% endif %}"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Số máy của xe</label>
                        <input
                            type="text"
                            name="so_may"
                            value="{% if vehicle %}{{ vehicle.so_may }}{% endif %}"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>
                </div>
            </div>
            {% endif %}

            {% if loai_mau in [2, 3, 4, 7, 8, 9] %}
            <!-- For forms about ownership changes -->
            <div class="bg-blue-50 p-4 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-3">Thông tin người mua/đang sử dụng</h4>

                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tên người mua/đang sử dụng xe</label>
                        <input
                            type="text"
                            name="ten_nguoi_mua"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ hiện tại</label>
                        <input
                            type="text"
                            name="dia_chi_nguoi_mua"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>

                    <div class="grid md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Số CCCD/mã số thuế</label>
                            <input
                                type="text"
                                name="so_cccd_nguoi_mua"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ngày cấp CCCD</label>
                            <input
                                type="date"
                                name="ngay_cap_cccd_nguoi_mua"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Số điện thoại</label>
                            <input
                                type="text"
                                name="so_dien_thoai_nguoi_mua"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Bản sao chứng từ chuyển nhượng (nếu có)</label>
                        <select name="ban_sao_chuyen_nhuong" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">Chọn</option>
                            <option value="Có">Có</option>
                            <option value="Không">Không</option>
                        </select>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if loai_mau in [5, 10] %}
            <!-- For new vehicles -->
            <div class="bg-green-50 p-4 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-3">Thông tin xe mới</h4>

                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Số khung</label>
                        <input
                            type="text"
                            name="so_khung"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Số máy</label>
                        <input
                            type="text"
                            name="so_may"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                        >
                    </div>
                </div>
            </div>
            {% endif %}

            {% if loai_mau == 10 %}
            <!-- For form 10 specifically: Seller and current user info -->
            <div class="bg-purple-50 p-4 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-3">Thông tin người đang sử dụng xe</h4>
                <div class="space-y-3">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tên người đang sử dụng xe</label>
                            <input
                                type="text"
                                name="ten_nguoi_dang_su_dung"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ người đang sử dụng</label>
                            <input
                                type="text"
                                name="dia_chi_nguoi_dang_su_dung"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-orange-50 p-4 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-3">Thông tin người bán xe</h4>
                <div class="space-y-3">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tên người bán xe</label>
                            <input
                                type="text"
                                name="ten_nguoi_ban"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ người bán</label>
                            <input
                                type="text"
                                name="dia_chi_nguoi_ban"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>
                    </div>

                    <div class="grid md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Số điện thoại người bán</label>
                            <input
                                type="text"
                                name="so_dien_thoai_nguoi_ban"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Số CCCD/mã số thuế người bán</label>
                            <input
                                type="text"
                                name="so_cccd_nguoi_ban"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ngày cấp CCCD người bán</label>
                            <input
                                type="date"
                                name="ngay_cap_cccd_nguoi_ban"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                            >
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Bản sao chứng từ chuyển nhượng (nếu có)</label>
                        <select name="ban_sao_chuyen_nhuong" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">Chọn</option>
                            <option value="Có">Có</option>
                            <option value="Không">Không</option>
                        </select>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Additional info -->
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tình trạng phương tiện</label>
                    <select name="tinh_trang_xe" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                        <option value="">Chọn tình trạng</option>
                        <option value="Tốt">Tốt</option>
                        <option value="Hỏng">Hỏng</option>
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Ghi chú</label>
                <textarea
                    name="ghi_chu"
                    rows="3"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                    placeholder="Thông tin bổ sung (nếu có)"
                ></textarea>
            </div>

            <!-- Submit buttons -->
            <div class="flex space-x-4">
                <button
                    type="submit"
                    class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold"
                >
                    Tiếp tục →
                </button>
                <a
                    href="/tra-cuu"
                    class="px-6 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition font-semibold"
                >
                    Hủy
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    document.getElementById('requestForm').addEventListener('submit', function(e) {
        e.preventDefault();

        // Submit to review page instead of directly creating request
        const form = this;
        form.action = '/yeu-cau/review';
        form.method = 'POST';
        form.submit();
    });
</script>
{% endblock %}
